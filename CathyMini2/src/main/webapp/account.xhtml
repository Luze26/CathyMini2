<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >
    <h:body>

        <ui:composition template="template/commonLayout.xhtml">
            <ui:param name="ngApp" value="account" />
            <ui:param name="ngController" value="accountSettingsCtrl" />
            <ui:param name="title" value="CathyMini" />
            <ui:define name="content">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#infos" data-toggle="tab">Mes infos</a></li>
                    <li><a href="#achats" data-toggle="tab">Mes achats</a></li>
                    <li><a href="#abonnments" data-toggle="tab">Mes abonnements</a></li>
                </ul>
                <div class="tab-content">
                    <div id="infos" class="tab-pane active">
                        <fieldset>
                            <legend>Vos param√®tres</legend>
                            <div class="form-group" ng-repeat="field in fields">
                                {{field.label}}: {{$parent.consumer[field.key]}}
                                <a href="#" class="account-edit" ng-show="field.editable" ng-click="showEdit(field)">Edit</a>
                                <img ng-show="field.loading" src="/assets/image/loading.gif" alt="loading" />
                                <img ng-show="field.success" src="/assets/image/ok.png" alt="success" />
                                <p ng-show="field.error">{{field.error}}</p>
                                <div ng-hide="field.editable">
                                    <input type="text" class="form-control" ng-model="$parent.editConsumer[field.key]" />
                                    <button type="button" class="btn btn-success" ng-click="edit(field)">Edit</button>                     
                                    <button type="button" class="btn" ng-click="cancelEdit(field)">Annuler</button>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset>
                            <legend>Vos adresses</legend>
                            <table class="table table-striped table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th>Adresse</th>
                                        <th>Code postal</th>
                                        <th>Ville</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="addr in address">
                                        <td>{{addr.address}}</td>
                                        <td>{{addr.zipCode}}</td>
                                        <td>{{addr.city}}</td>
                                        <td><span ng-click="initEditAddress(addr)" class="btn btn-primary" data-toggle="modal" data-target="#addressModal">Edit</span>
                                            <span ng-click="deleteAddress(addr)" class="btn btn-primary" data-toggle="modal">Supprimer</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <button type="button" ng-click="modal = newModal" class="btn btn-primary" data-toggle="modal" data-target="#addressModal">Ajouter une adresse</button>
                            <ui:include src="/partials/addressModal.xhtml" />
                        </fieldset>
                    </div>
                    <div id="achats" class="tab-pane"></div>
                    <div id="abonnements" class="tab-pane"></div>
                </div>            
            </ui:define>

            <ui:define name="scripts">
                <script src="/assets/js/modules/accountModule.js"></script>
                <script src="/assets/js/controllers/accountCtrls.js"></script>
                <script src="/assets/js/modules/addressModule.js"></script>
                <script src="/assets/js/controllers/addressCtrls.js"></script>
            </ui:define>
        </ui:composition>

    </h:body>

</html>