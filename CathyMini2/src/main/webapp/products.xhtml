<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >
    <h:body>

        <ui:composition template="template/commonLayout.xhtml">
            <ui:param name="ngApp" value="products" />
            <ui:param name="ngController" value="productsCtrl" />
            <ui:param name="title" value="CathyMini - Catalogue" />
            <ui:define name="content">
                <cart-directive></cart-directive>
                <ui:include src="/partials/searchPanel.xhtml" />
                <div class="row" ng-class="displaySearchPanel == true ? 'row-products' : 'row-products-top'">
                    <div class="col-xs-12" infinite-scroll="loadProducts()" infinite-scroll-distance="2">
                        <div class="col-xs-12" ng-show="products.length == 0" ng-cloak="ng-cloak">
                            Cathy n'a trouvé aucun produit pour votre recherche.
                        </div>
                        <div class="col-xs-12 col-sm-6 col-md-4 product-container" ng-repeat="prod in products" ng-cloak="ng-cloak">
                            <div type="button" data-toggle="modal" data-target="#productOverlay"
                                 ng-click="showProduct(prod)" class="product">

                                <div class="product-aura">
                                    <div class="type">
                                        <img ng-if="prod.type==='serviette'" src="assets/images/serviette.png"/>
                                        <img ng-if="prod.type==='tampon'" src="assets/images/tampon.png"/>
                                    </div>
                                    <div class="row">
                                        <div class="image col-xs-5">
                                            <div class="image-container">
                                                <img class="imgGallery img-thumbnail" ng-src="{{cheminImageProduit}}{{prod.pictureUrl}}"/>
                                            </div>
                                            <button class="btn btn-primary dropdown" data-toggle="dropdown">
                                                <label style="margin-bottom: 0px; cursor: pointer;"><img class="product-icon" src="/assets/images/add.png" alt="+"/>Ajouter</label>
                                                <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                                    <li><a class="btn" title="ajouter au panier" ng-click="addProductToCart($event, prod)">Ajouter au panier</a></li>
                                                    <li><a class="btn" ng-hide="showAddSub()" title="nouveau abonnement" ng-hide="showAddSub()" ng-click="newSubscription($event)">Nouveau abonnement</a></li>
                                                    <li title="ajouter à l'abonnement" ng-repeat="sub in subService.sub"><a class="btn" ng-click="addProductToSub($event, prod, sub.name)">Ajouter à {{sub.name}}</a></li>
                                                </ul>
                                            </button>
                                            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                                <li><a title="ajouter au panier" class="btn" ng-click="addProductToCart($event, prod)">Ajouter au panier</a></li>
                                                <li><a title="ajouter à un abonnement" class="btn" ng-click="addProductToSub($event, prod)">Ajouter à un abonnement</a></li>
                                            </ul>
                                         </div>
                                         <div class="infos col-xs-7">
                                             <div class="mid">{{prod.name}} <br /> <span class="brandName">{{prod.marque}}</span></div>
                                             <div class="drops-c drops-c-6 drops-active-{{prod.flux}}"><div class="drops-inner"></div></div>
                                             <div ng-show="prod.appli" class="brandName">Avec applicateur.</div>
                                             <div class="price">{{prod.price}}€</div>
                                         </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <ui:include src="/partials/productOverlay.xhtml" />
            </ui:define>

            <ui:define name="scripts">
                <script src="/assets/js/lib/angular-slider.min.js"></script>
                <script src="/assets/js/lib/ng-infinite-scroll.min.js"></script>
                <script src="/assets/js/modules/productsModule.js"></script>
                <script src="/assets/js/controllers/productsCtrls.js"></script>
                <script src="/assets/js/services/consumerService.js"></script>
                <script src="/assets/js/services/cartService.js"></script>
                <script src="/assets/js/services/subscriptionService.js"></script>
                <script src="/assets/js/directives/cartDirective.js"></script>
                <script src="/assets/js/directives/form/formDirective.js"></script>
            </ui:define>
            <ui:define name="css">
                <link rel="stylesheet" type="text/css" href="/assets/css/lib/angular-slider.min.css"></link>
            </ui:define>
        </ui:composition>

    </h:body>

</html>
